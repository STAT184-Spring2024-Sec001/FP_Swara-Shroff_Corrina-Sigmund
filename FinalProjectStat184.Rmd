---
title: "Final Project"
author: "Corrina Sigmund and Swara Shroff"
date: "2024-04-12"
output: 
  html_document:
    df_print: paged
    code_folding: hide
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(kableExtra)
library(janitor)
library(dplyr)

heart_attack_pred_data <- read.csv("https://drive.google.com/uc?export=download&id=1HrZR4RsUUkYLhxkNhXNuoU8uqoQrLBbh")

```
#Research Question

## (add the question)

# Stress Level vs. Sex in Patients At Risk and Not at Risk for Heart Attack

### Using two boxplots, we want to compare the average stress levels on a scale of one to ten in male and female patients at risk and not at risk for a heart attack. By separating the patients into these two categories, we are able to consider whether or not stress level plays an important role in leading to a heart attack within patients.


## Stress Level vs. Sex for Patients At Risk for a Heart Attack

### This graph shows the average stress levels for male and female patients at risk for a heart attack using a box plot. The stress levels of patients was measured on a scale of one to ten.

```{r stress level in patients at risk for heart attack}
heart_attack_pred_data  %>% 
  select(Stress.Level, Sex, Heart.Attack.Risk) %>% 
  filter(Heart.Attack.Risk != 0) #at risk for heart attack
  ggplot(heart_attack_pred_data) + 
  aes (x = Stress.Level, y = Sex, fill = Sex) +
  geom_boxplot() +  
  scale_fill_manual(values = c("salmon", "turquoise")) +  # Choose color palette
  labs(x = "Stress Level", y = "Sex", fill = "Sex") +  # Add axis labels and legend title
  ggtitle("Stress Level for each Sex") +  # Add plot title
  theme_minimal() + # Choose a theme
  scale_x_continuous(breaks = seq(0, max(heart_attack_pred_data$Stress.Level), by = 1)) #Makes x-axis count by 1
```
## Stress Level vs. Sex for Patients At Risk for a Heart Attack Visualisation Description

### Through this boxplot, we can see that the average stress level in female patients at risk for a heart attack is a six out of ten. The average stress level in male patients at risk for a heart attack is a five out of ten. According to this data, the average stress levels for patients at risk for a heart attack is higher for females by one point.


## Stress Level vs. Sex for Patients Not At Risk for a Heart Attack

### This graph shows the average stress levels for male and female patients not at risk for a heart attack using a box plot. The stress levels of patients was measured on a scale of one to ten.

```{r stress level in patients not at risk for heart attack}
heart_attack_pred_data  %>% 
  select(Stress.Level, Sex, Heart.Attack.Risk) %>% 
  filter(Heart.Attack.Risk != 1) #not at risk for heart attack
  ggplot(heart_attack_pred_data) + 
  aes (x = Stress.Level, y = Sex, fill = Sex) +
  geom_boxplot() +  
  scale_fill_manual(values = c("#F4C2C2", "#89CFF0")) +  # Choose color palette
  labs(x = "Stress Level", y = "Sex", fill = "Sex") +  # Add axis labels and legend title
  ggtitle("Stress Level for each Sex") +  # Add plot title
  theme_minimal() + # Choose a theme
  scale_x_continuous(breaks = seq(0, max(heart_attack_pred_data$Stress.Level), by = 1)) #Makes x-axis count by 1
```
## Stress Level vs. Sex for Patients Not At Risk for a Heart Attack Visualisation Description

### Through this boxplot, we can see that the average stress level in female patients not at risk for a heart attack is a six out of ten. The average stress level in male patients not at risk for a heart attack is a five out of ten. According to this data, the average stress levels for patients not at risk for a heart attack is higher for females by one point.


## Conclusions for Stress Level vs. Sex in Patients At Risk and Not at Risk for Heart Attack

### Through the data that we obtained, it is clear to see that all female patients, no matter their risk for a heart attack, have an average stress level of six and all male patients have an average stress level of five. Therefore, stress level is not a main factor in heart attacks in patients.


## Average Risk for Heart Attack by Age and Sex

```{r average heart attack risk by age and sex}
hr <- heart_attack_pred_data %>%
  group_by(Age, Sex) %>%
  summarise(avg_heart_attack_risk = mean(Heart.Attack.Risk))

# Create the barplot
ggplot(hr, aes(x = Age, y = avg_heart_attack_risk, fill = Sex)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Age", y = "Average Heart Attack Risk", title = "Average Heart Attack Risk by Age and Sex") +
  scale_fill_manual(values = c("maroon", "#4169e1"))
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## Heart Rate vs. Sex
```{r heart rate vs sex}
heart_attack_pred_data  %>% 
  select(Heart.Rate, Sex)
  
  ggplot(heart_attack_pred_data) +
  aes(x = factor(Heart.Rate), fill = Sex) +  # Convert to factor for discrete data
  geom_bar(position = "dodge", stat = "count") +  # Create a bar plot with dodged bars
  scale_fill_brewer(palette = "Set1") +  # Choose color palette
  labs(x = "Heart Rate", y = "Number of Individuals", fill = "Sex") +  # Add axis labels and legend title
  ggtitle("Heart Rate for Each Sex") +  # Add plot title
  theme_minimal()  # Choose a theme

```

## Physical Activity Days per Week V. BMI Frequency Table

```{r physical activty v. BMI}
SummaryTableofBMI <- heart_attack_pred_data %>%
  group_by(Physical.Activity.Days.Per.Week) %>% #groups the all BMI cases with the physical acivity per week attribute 
  summarise(
  count = n(), #finds total case count
  min = min(BMI, na.rm = TRUE), #finds min value
  quintile1 = quantile(BMI, probs = 0.20, na.rm = TRUE), #get 20th percentile
  quintile2 = quantile(BMI, probs = 0.40 , na.rm = TRUE), #gets 40th percentile
  median = median(BMI, na.rm = TRUE), #finds median
  quintile3 = quantile(BMI, probs = 0.60, na.rm = TRUE), #gets 60th percentile
  quintile4 = quantile(BMI, probs = 0.80, na.rm = TRUE), #gets 80th percentile
  max = max(BMI, na.rm = TRUE), #finds max
  mean = mean(BMI, na.rm = TRUE), #finds mean
  StandardDeviation = sd(BMI, na.rm = TRUE) #finds sd
)
#polish
SummaryTableofBMI %>%
  kable(
    align = c("l", rep("c", 10))      #left indents the first column and centers the rest of the columns
  ) %>% 
  kable_styling(full_width = FALSE, stripe_color = "pink")

```