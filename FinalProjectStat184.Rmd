---
title: "Final Project"
author: "Corrina Sigmund and Swara Shroff"
date: "2024-04-12"
output: 
  html_document:
    df_print: paged
    code_folding: hide
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(kableExtra)
library(janitor)
library(dplyr)

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


## Stress Level v. Gender
Stress levels -- scale of 1 to 10

```{r stress level}
heart_attack_pred_data<-heart_attack_prediction_dataset.2  %>% 
  select(Stress.Level, Sex)
  ggplot(heart_attack_pred_data) + 
  aes (x = Stress.Level, color = Sex) +
  geom_boxplot() +  
  scale_color_brewer(palette = "Set1") +  # Choose color palette
  labs(x = "Stress Level", color = "Sex") +  # Add axis labels and legend title
  ggtitle("Stress Level for each Sex") +  # Add plot title
  theme_minimal() + # Choose a theme
  scale_x_continuous(breaks = seq(0, max(heart_attack_pred_data$Stress.Level), by = 1)) #Makes x-axis count by 1





```

## Cholesterol vs Triglycerides in Patients at Risk of Heart Attack

```{r cholesterol vs triglyceride levels}
heart_attack_pred_data<-heart_attack_prediction_dataset.2  %>% 
  filter(Heart.Attack.Risk != 0)
  
  ggplot(heart_attack_pred_data) + 
  aes (x = Cholesterol, y = Triglycerides, color = Sex) +
  geom_point() +  
  scale_color_brewer(palette = "Set2") +  # Choose color palette
  labs(x = "Cholesterol Level", y = "Triglycerides Level", color = "Sex") +  # Add axis labels and legend title
  ggtitle("Level of Cholesterol vs Triglycerides in Patients at Risk of Heart Attack") +  # Add plot title
  theme_minimal() # Choose a theme
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## Diet V. Sex
```{r number of physical activity days vs sex}
heart_attack_pred_data<-heart_attack_prediction_dataset.2  %>% 
  select(Heart.Rate, Sex)
  
  ggplot(heart_attack_pred_data) +
  aes(x = factor(Heart.Rate), fill = Sex) +  # Convert to factor for discrete data
  geom_bar(position = "dodge", stat = "count") +  # Create a bar plot with dodged bars
  scale_fill_brewer(palette = "Set1") +  # Choose color palette
  labs(x = "Heart Rate", y = "Number of Individuals", fill = "Sex") +  # Add axis labels and legend title
  ggtitle("Heart Rate for Each Sex") +  # Add plot title
  theme_minimal()  # Choose a theme

```

## Physical Activity Days per Week V. BMI Frequency Table

```{r physical activty v. BMI}
SummaryTableofBMI <- heart_attack_prediction_dataset.2 %>%
  group_by(Physical.Activity.Days.Per.Week) %>% #groups the all BMI cases with the physical acivity per week attribute 
  summarise(
  count = n(), #finds total case count
  min = min(BMI, na.rm = TRUE), #finds min value
  quintile1 = quantile(BMI, probs = 0.20, na.rm = TRUE), #get 20th percentile
  quintile2 = quantile(BMI, probs = 0.40 , na.rm = TRUE), #gets 40th percentile
  median = median(BMI, na.rm = TRUE), #finds median
  quintile3 = quantile(BMI, probs = 0.60, na.rm = TRUE), #gets 60th percentile
  quintile4 = quantile(BMI, probs = 0.80, na.rm = TRUE), #gets 80th percentile
  max = max(BMI, na.rm = TRUE), #finds max
  mean = mean(BMI, na.rm = TRUE), #finds mean
  StandardDeviation = sd(BMI, na.rm = TRUE) #finds sd
)
#polish
SummaryTableofBMI %>%
  kable() %>% 
  kable_styling(full_width = FALSE, stripe_color = "pink")

```

